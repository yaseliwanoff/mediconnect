{% extends 'main/base.html' %}
{% load static %}

{% block title %}My appointments{% endblock %}

{% block body %}

{% if appointments %}
<div class="sidebar">
    <form method="post">
        {% csrf_token %}
        {{ filter_form.as_p }}
        <button type="submit">Filter</button>
    </form>
</div>

<ul>
    {% for appointment in appointments %}
    <li>
        <div class="doctor__list__img">
            <img src="{{ appointment.doctor.photo.url }}" alt="doctor image" class="doctor__photo">
        </div>
        <strong>{{ appointment.doctor }}</strong> ({{ appointment.doctor.specialization }}) on {{ appointment.appointment_day }} {{ appointment.appointment_time }}<br>
    </li>
    <div class="cart_item-content">
        <form action="{% url 'Cancel' appointment.id %}" method="POST">
            {% csrf_token %}
            <button type="submit" class="remove-btn">Cancel</button>
        </form>
    </div>
    {% endfor %}
</ul>
{% endif %}
{% if is_paginated %}
<div class="pagination">
    <span class="step-links">
      {% if page_obj.has_previous %}
        <a href="?page=1">&laquo; first</a>
        <a href="?page={{ page_obj.previous_page_number }}">previous</a>
      {% endif %}

      {% for page_num in page_obj.paginator.page_range %}
        {% if page_obj.number == page_num %}
          <span class="current">{{ page_num }}</span>
        {% elif page_num > page_obj.number|add:'-5' and page_num < page_obj.number|add:'5' %}
          <a href="?page={{ page_num }}">{{ page_num }}</a>
        {% endif %}
      {% endfor %}

      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}">next</a>
        <a href="?page={{ page_obj.paginator.num_pages }}">last &raquo;</a>
      {% endif %}
    </span>
</div>
{% else %}
<p>You don`t have an appointments</p>
<a href="{% url 'DoctorList' %}">Make an appointment</a>
{% endif %}
{% endblock %}
